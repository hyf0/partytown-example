const e=(e,t,r)=>new Response(e,{headers:{"content-type":1===t?"application/json":"text/html","Cache-Control":0===r?"max-age=31556952,immutable":"no-store"}}),t=new Map,r=e=>{const r=e.data,n=t.get(r.A);n&&(t.delete(r.A),clearTimeout(n[1]),n[0](r))},n=(e,t)=>({K:e.K,A:e.A,H:[],n:[t]});(s=>{s.oninstall=()=>s.skipWaiting(),s.onactivate=()=>s.clients.claim(),s.onmessage=r,s.onfetch=r=>((r,s)=>{const o=s.request,i=new URL(o.url).pathname;i.endsWith("partytown-sandbox")?s.respondWith(e('<!DOCTYPE html><html><head><meta charset="utf-8"><script type="module" async>(e=>{const t=e=>e.length,r=e=>e&&e.constructor&&e.constructor.name||"",n=()=>{},s=(e,t)=>e.startsWith(t),o=e=>!(s(e,"webkit")||s(e,"toJSON")||s(e,"on")&&e.toLowerCase()===e),i=[],a=new Map,c=new WeakMap,h=[],u=new WeakMap,d=new Map,l=new WeakSet,p=(e,t,r)=>t?("number"!=typeof(r=(e=>{if(e){const t=e.nodeName;return"#document"===t?4:"HTML"===t?5:"HEAD"===t?6:"BODY"===t?7:c.get(e)}return-1})(t))&&f(e,t,r=Math.round(9999999999*Math.random()+7)),r):-1,$=(e,t,r)=>{const n=e.J.document;return 4===t?n:5===t?n.documentElement:6===t?n.head:7===t?n.body:(r=h.find((e=>e[0]===t)))?r[1]:null},f=(e,r,n)=>{if(r&&(h.push([n,r]),c.set(r,n),e.c++,e.c>99))for(e.c=0;;){let e,r,n=h.filter((e=>e[1].nodeType&&!e[1].isConnected));if(!(t(n)>99))break;for(e=0,r=t(h);e<r;e++)if(!h[e][1].isConnected){h.slice(e,1);break}}},m=(e,t,n,s,i,a)=>{if(void 0!==t){if(n=n||new Set,"string"==(s=typeof t)||"number"===s||"boolean"===s||null==t)return[4,t];if("function"===s)return[2];if(Array.isArray(t))return n.has(t)?[0,[]]:(n.add(t),[0,t.map((t=>m(e,t,n)))]);if("object"===s){if(t.nodeType)return[1,{K:e.K,u:t.nodeType,r:p(e,t),C:t.nodeName}];if(t===t.window)return[1,{K:e.K,u:0,r:0}];if(y(r(t)))return[1,{K:e.K,u:7,v$:Array.from(t).map((t=>m(e,t,n)[1]))}];if(i={},!n.has(t))for(a in n.add(t),t)o(a)&&(i[a]=m(e,t[a],n));return[3,i]}}},g=(e,t,r,n,s,o,i)=>{if(r){if(n=r[0],s=r[1],4===n)return s;if(5===n)return w(e,t,s);if(0===n)return s.map((r=>g(e,t,r)));if(1===n)return $(e,s.r);if(3===n){for(i in o={},s)o[i]=g(e,t,s[i]);return o}}},y=e=>"HTMLCollection"===e||"NodeList"===e,w=(e,t,r)=>{let s,o,i=$(e,t);return i?(s=u.get(i),s||u.set(i,s={}),o=s[r],o||(o=I(e,r),s[r]=o),o):n},I=(e,t)=>function(...r){const n=m(e,this),s=m(e,r);e.L.postMessage([4,t,n,s])},S=e=>{const r=e.K,n=e.J,s=n.document,o=s.querySelector(\'script[type="text/partytown"]:not([data-pt-id]):not([data-pt-error])\');if(o){const t=p(e,o,r),n={K:r,r:t};o.dataset.ptId=E(e,t),o.src?n.I=o.src:n.e=o.innerHTML,e.L.postMessage([3,n])}else e.w||(e.w=!0,n.frameElement&&(n.frameElement.partyWinId=r),((e,r)=>{let n=r._ptf,s=0;if(n){for(r._ptf.push=(t,r)=>e.L.postMessage([7,t,m(e,Array.from(r))]);s<t(n);s+=2)r._ptf.push(n[s],n[s+1]);n.length=0}})(e,n),s.dispatchEvent(new CustomEvent("ptinit")))},E=(e,t)=>e.K+"."+t,b=(e,t)=>{let n,s,i,a;for(n in e)o(n)&&(i=e[n],a=typeof i,"function"===a?t[n]=2:"object"===a&&(s=k[r(i)],s&&(t[n]=s)));return t},k={CSSStyleDeclaration:11,DOMStringMap:5,DOMTokenList:6,NamedNodeMap:4,NodeList:7},M=(e,t)=>t[0]in e;(async(e,r)=>{const n=e.parent,s=e.navigator.serviceWorker,o=await s.getRegistration(),c=e=>{const r=e.data,n=r.K,s=d.get(n);s&&(async(e,r)=>{if(r.a)return((e,t)=>new Promise((r=>{a.set(t.A,r),e.postMessage([5,t])})))(e.L,r);const n={A:r.A,K:r.K,n:[]};for(const o of r.H){let r,a,c,h,u,d,l,p=o.r,y=o.b,w=o.z,I=t(w),S=w[I-1],E=o.p||i;try{if(r=$(e,p),r){for(h=0;h<I-1;h++)r=r[w[h]];c=g(e,p,o.h),0===y?("partyWinId"===S&&await new Promise((e=>{u=0,d=setInterval((()=>{(M(r,w)||u>99)&&(clearInterval(d),e()),u++}),40)})),a=r[S]):1===y?r[S]=c:2===y&&(a=r[S].apply(r,c),E.map((t=>{l=t[0][0],a[l]=g(e,p,t[1])})),o.B&&f(e,a,o.B)),"object"==typeof(s=a)&&s&&s.then&&(a=await a,n.x=!0),n.F=m(e,a)}else n.n.push(`Instance ${p} not found`)}catch(e){n.n.push(String(e.stack||e))}}var s;return n})(s,r).then((e=>{o&&o.active&&o.active.postMessage(e)}))},h=e=>{if(!l.has(e)){l.add(e);const t=e.parent,i={K:e.partyWinId=r++,D:t.partyWinId,d:n.partytown,c:0,G:o.scope,I:e.document.baseURI,J:e};d.set(i.K,i),f(i,e,0),f(i,e.history,1),f(i,e.localStorage,2),f(i,e.sessionStorage,3),s.addEventListener("message",c),(e=>{e.L=new Worker(URL.createObjectURL(new Blob([\'(e=>{const t={},r=Symbol(),n=Symbol(),s=Symbol(),o=Symbol(),i=Symbol(),a=Symbol(),c={},$=new WeakMap,u={},h={},l=e=>e.toUpperCase(),d=e=>e.length,p=(e,t)=>setTimeout(e,t),m=[],g="text/partytown",f=\\\'<script src="/~partytown/partytown.js" async defer><\\\\/script>\\\',y=()=>Math.round(9999999999*Math.random()+7),w=(e,t)=>S(e[n],t),S=(e,t,r)=>(r=u[e])?r[t]:void 0,I=(e,t,r)=>E(e[n],t,r),E=(e,t,r,n)=>{(n=u[e]||{})[t]=r,u[e]=n},T=(e,t,r)=>((r=S(e,t))&&p((()=>r.map((e=>e({type:"error"===t?"error":"load"}))))),!!r),b=(e,t)=>{h.f=e,h.g=t},R=e=>new URL(e||"",h.y+""),x=e=>R(w(e,"href")),M=(e,t)=>{try{return fetch(e,{method:"POST",mode:"no-cors",keepalive:!0}),!0}catch(e){return console.error(e),!1}};class k{constructor(e,t,i,c){return this[r]=i||h.K,this[n]=t,this[o]=c,this[a]=void 0,z(this[s]=e,this,[])}}class v extends k{appendChild(e){return this.insertBefore(e,null)}get ownerDocument(){return document}get href(){}set href(e){}insertBefore(e,t){return Y(this[r],e),"IFRAME"===(e=V(this,["insertBefore"],[e,t],m))[o]?(e=>{let t=w(e,1)?"load":"error",r=w(e,t);r&&r.forEach((e=>e({type:"load"})))})(e):"SCRIPT"===e[o]&&h.E([3]),e}get nodeName(){return this[o]}get nodeType(){return this[s]}}class N{constructor(e){(this._=e).forEach(((e,t)=>this[t]=e))}entries(){return this._.entries()}forEach(e,t){this._.forEach(e,t)}item(e){return this[e]}keys(){return this._.keys()}get length(){return d(this._)}values(){return this._.values()}[Symbol.iterator](){return this._[Symbol.iterator]()}}class P extends v{get localName(){return this.nodeName.toLowerCase()}get tagName(){return this.nodeName}}class j extends P{addEventListener(...e){let t=e[0],r=w(this,t)||[];r.push(e[1]),I(this,t,r)}get async(){return!0}set async(e){}get defer(){return!0}set defer(e){}get onload(){let e=w(this,"load");return e&&e[0]||null}set onload(e){I(this,"load",e?[e]:null)}get onerror(){let e=w(this,"error");return e&&e[0]||null}set onerror(e){I(this,"error",e?[e]:null)}}class C extends P{get hash(){return x(this).hash}get host(){return x(this).host}get hostname(){return x(this).hostname}get href(){return x(this)+""}set href(e){I(this,"href",e),q(this,["href"],e)}get origin(){return x(this).origin}get pathname(){return x(this).pathname}get port(){return x(this).port}get protocol(){return x(this).protocol}get search(){return x(this).search}}class O extends j{get contentDocument(){return this.contentWindow.document}get contentWindow(){let e=w(this,2);return e||(e=U(this,["partyWinId"]),I(this,2,e)),new A(0,0,e)}get src(){return w(this,3)||""}set src(e){let t,r,n=new XMLHttpRequest;e=R(e)+"",this.src!==e&&(I(this,3,e),n.open("GET",e,!1),n.send(),r=n.status>199&&n.status<300,I(this,1,r),r&&(t=((e,t)=>`<base href="${e}">`+t.replace(/<script>/g,\\\'<script type="text/partytown">\\\').replace(/<script /g,\\\'<script type="text/partytown" \\\').replace(/text\\\\/javascript/g,g)+f)(e,n.responseText),this[a]?this[a].push([["srcdoc"],X(t)]):q(this,["srcdoc"],t)))}}class A extends k{get document(){return W(9,4,this[r])}get parent(){return W(0,0,h.D)}get self(){return this}get top(){return top}get window(){return this}}class B extends P{get body(){return W(1,7,this[r],"BODY")}get compatMode(){return h.i}get cookie(){return h.j,h.j}set cookie(e){q(this,["cookie"],h.j=e)}createElement(e){e=l(e);const t=this[r],n=y(),s=new(_(e))(1,n,t,e);return s[a]="SCRIPT"===e?[[["type"],X(g)]]:"IFRAME"===e?[[["srcdoc"],X(f)]]:[],s}get createEventObject(){}get currentScript(){return h.f?W(1,h.f,this[r],"SCRIPT"):null}get defaultView(){return e}get documentElement(){return W(1,5,this[r],"HTML")}getElementsByTagName(e){return"BODY"===(e=l(e))?[this.body]:"HEAD"===e?[this.head]:"SCRIPT"===e?[W(1,h.o,this[r],"SCRIPT")]:V(this,["getElementsByTagName"],[e])}get head(){return W(1,6,this[r],"HEAD")}get implementation(){return{hasFeature:()=>!0}}get location(){return h.y,h.y}set location(e){h.y.href=e+""}get parentNode(){return null}get parentElement(){return null}get readyState(){return"complete"!==h.k?h.k=U(this,["readyState"]):h.k,h.k}get referrer(){return h.l,h.l}get title(){return h.m,h.m}set title(e){q(this,["title"],h.m=e)}}class D extends P{get parentElement(){return document.documentElement}get parentNode(){return document.documentElement}}class L extends j{get src(){return this[r]===h.K?w(this,3)||"":U(this,["src"])}set src(e){this[r]===h.K?(e=R(e)+"",I(this,3,e),this[a]&&this[a].push([["src"],X(e)])):q(this,["src"],e)}get type(){return U(this,["type"])}set type(e){"text/javascript"!==e&&q(this,["type"],e)}}const W=(e,t,r,n)=>new(F(e,n=9===e?"#document":3===e?"#text":n))(e,t,r,n),F=(e,t)=>1===e?_(t):9===e?B:0===e?A:3===e?v:k,_=e=>({A:C,BODY:D,HEAD:D,IFRAME:O,SCRIPT:L}[e]||P),H=(e,i,a,c,$,u)=>{const l=e[r],d=t[l]=t[l]||[],p=h.K!==l,m={r:e[n],u:e[s],C:e[o],b:i,z:a,h:c,p:$,B:u};return d.push(m),J(l,e,a,p,d)},J=(e,t,r,n,s)=>{if(d(s)){const o={A:y(),K:e,a:n,H:[...s]};s.length=0;const i=new XMLHttpRequest;JSON.stringify(o),i.open("POST",h.G+"proxytown",!1),i.send(JSON.stringify(o));const a=JSON.parse(i.responseText),c=a.n.join(),$=a.x,u=G(t,r,a.F);if(c){if($)return Promise.reject(c);throw new Error(c)}return $?Promise.resolve(u):u}},U=(e,t)=>{Y(e[r],e);return H(e,0,t)},q=(e,t,r)=>{if(e[a])e[a].push([t,X(r)]);else{const n=X(r);"function"==typeof r&&I(e,t.join("."),r),H(e,1,t,n)}},V=(e,t,n,s,o)=>{Y(e[r],e);return H(e,2,t,X(n),s,o)},Y=(e,t)=>{const r=t[a];if(r){t[a]=void 0;const s=W(9,4,e,"#document");V(s,["createElement"],[t[o]],r,t[n])}},z=(e,t,r)=>!t||"object"!=typeof t&&"function"!=typeof t||t[i]||String(t).includes("[native")?t:new Proxy(t,{get(t,n){if(n===i)return!0;if(Reflect.has(t,n))return Reflect.get(t,n);const s=[...r,String(n)];return((e,t,r)=>{const n=h.t.find((t=>t[0]===e));if(n){const e=n[1][r[d(r)-1]];if(2===e)return(...e)=>V(t,r,e);if(e>0)return z(e,t,[...r])}const s=w(t,r.join("."));return"function"==typeof s?(...e)=>s.apply(t,e):null})(e,t,s)||U(t,s)},set:(e,t,n,s)=>(Reflect.has(e,t)?Reflect.set(e,t,n,s):q(e,[...r,String(t)],n),!0)}),X=(e,t)=>{if(void 0!==e){t=t||new Set;const u=typeof e;if("string"===u||"boolean"===u||"number"===u||null==e)return[4,e];if("function"===u)return[5,(i=e,(a=$.get(i))||($.set(i,a=y()),c[a]=i),a)];if(Array.isArray(e))return t.has(e)?[0,[]]:[0,e.map((e=>X(e,t)))];if("object"===u){if("number"==typeof e[n])return[1,{K:e[r],u:e[s],r:e[n],C:e[o]}];const i={};if(!t.has(e)){t.add(e);for(const r in e)i[r]=X(e[r],t)}return[3,i]}}var i,a},G=(e,t,r,n,s,o,i)=>{if(r){if(n=r[0],s=r[1],4===n)return s;if(5===n)return Q(e,t,s);if(2===n&&e)return(...r)=>V(e,t,r);if(1===n)return K(s);if(0===n)return s.map((r=>G(e,t,r)));if(3===n){for(i in o={},s)o[i]=G(e,[...t,i],s[i]);return o}}},K=({u:t,r:r,K:n,C:s,v$:o})=>1===r?history:2===r?localStorage:3===r?sessionStorage:0===r?e:7===t?new N(o.map(K)):W(t,r,n,s),Q=(e,t,r)=>{let n,s=w(e,0);return s||I(e,0,s={}),n=s[r],n||(s[r]=n=Z()),n},Z=e=>function(...e){};class ee{constructor(){this.s="",this.l=[],this.e=[]}get src(){return this.s}set src(e){fetch(R(e)+"",{mode:"no-cors",keepalive:!0}).then((e=>{e.ok?this.l.forEach((e=>e({type:"load"}))):this.e.forEach((e=>e({type:"error"})))}),(()=>this.e.forEach((e=>e({type:"error"})))))}addEventListener(e,t){"load"===e&&this.l.push(t),"error"===e&&this.e.push(t)}get onload(){return this.l[0]}set onload(e){this.l=[e]}get onerror(){return this.e[0]}set onerror(e){this.e=[e]}}class te extends URL{assign(){}reload(){}replace(){}}const re=[],ne=t=>{const s=t.data,o=s[0],i=s[1],a=s[2];h.w?3===o?(e=>{e.K;let t=e.r,r=e.e,n=e.I,s="",o="load";if(n){try{n=R(n)+"",E(t,3,n),b(t,n),h.q(n)}catch(e){console.error(name,e,"\\\\n"+n),o="error",s=String(e.stack||e)+""}T(t,o)||h.E([8,t,o])}else if(r)try{b(t,""),new Function(r)()}catch(e){console.error(name,e,"\\\\n"+r),o="error",s=String(e.stack||e)+""}b(-1,""),h.E([2,t,s])})(i):4===o?((e,t,r,n)=>{if(n=c[e])try{const e=G(null,[],t),s=G(e,[],r);n.apply(e,s)}catch(e){console.error(e)}})(i,a,s[3]):5===o?(e=>{const t={A:e.A,K:e.K,n:[]};for(const r of e.H){let n,s,o,i,a=r.b,c=r.z,$=d(c),u=c[$-1];try{for(n=K({...r,K:e.K}),i=0;i<$-1;i++)n=n[c[i]];o=G(n,c,r.h),0===a?s=n[u]:1===a?n[u]=o:2===a&&(s=4===r.r&&"createElement"===u?V(n,c,o,r.p,r.B):n[u].apply(n,o)),t.F=X(s)}catch(e){t.n.push(String(e.stack||e))}}h.E([6,t])})(i):7===o?((t,r)=>{let n,s=G({},[],r),o=e;t.split(".").forEach(((e,t,r)=>{o&&(n=o[e],t===r.length-1&&"function"==typeof n?n.apply(o,s):o=o[e])}))})(i,a):8===o&&T(i,a):1===o?(((e,t)=>{Object.assign(h,t),h.K,h.K>1&&h.D,h.q=importScripts.bind(e),e.importScripts=void 0,h.E=postMessage.bind(e),e.postMessage=(e,t)=>{JSON.stringify(e)},h.y=new te(t.I),((e,t)=>{e[r]=h.K,e[n]=0,Object.keys(t).forEach((r=>{e[r]||2!==t[r]||(e[r]=(...t)=>V(e,[r],t))})),e.requestAnimationFrame=e=>p((()=>e(Date.now())),9),e.cancelAnimationFrame=clearTimeout,Object.defineProperty(e,"location",{get:()=>h.y,set:e=>h.y.href=e+""}),e.document=W(9,4),e.history=W(8,1),e.localStorage=W(10,2),e.sessionStorage=W(10,3),e.Image=ee,navigator.sendBeacon=M,e.self=e.window=e,1===h.K?e.parent=e.top=e:(e.parent=W(0,0,h.D),e.top=W(0,0,1))})(e,t.t[0][1]),h.w=!0})(e,i),h.E([3]),p((()=>{re.slice().forEach(ne),re.length=0}))):re.push(t)};e.onmessage=ne,postMessage([0])})(self);\\n\'],{type:"text/javascript"})),{name:`Partytown (${e.K}) 🎉`}),e.L.onmessage=t=>((e,t)=>{const r=t[0],n=e.J.document;if(0===r){const t=p(e,n.querySelector("script")),r=((e,t)=>{const r=t.implementation.createHTMLDocument(),n=r.documentElement;return[[0,e],[9,r],[6,n.classList],[1,n],[8,e.history],[7,n.childNodes],[10,e.sessionStorage],[3,r.createTextNode("")]].map((([e,t])=>[e,b(t,{})]))})(e.J,n),s={K:e.K,D:e.D,d:e.d||{},i:n.compatMode,j:n.cookie,k:n.readyState,l:n.referrer,m:n.title,o:t,t:r,G:e.G,I:e.I};e.L.postMessage([1,s])}else if(3===r)S(e);else if(2===r)((e,t,r,n,s)=>{(s=t.querySelector(`[data-pt-id="${E(e,r)}"]`))&&(n?s.dataset.ptError=n:s.type+="-init"),S(e)})(e,n,t[1],t[2]);else if(6===r){const r=t[1],n=a.get(r.A);n&&(a.delete(r.A),n(r),S(e))}else 8===r&&d.forEach((e=>e.L.postMessage(t)))})(e,t.data)})(i),e.addEventListener("load",(()=>S(i)))}};n.partyWin=h,o&&h(n)})(e,1)})(window);\n<\/script></head></html>',0,1)):i.endsWith("proxytown")&&s.respondWith(((r,s)=>new Promise((async o=>{const i=await s.clone().json(),a=await((e,r)=>new Promise((async s=>{const o=[...await e.clients.matchAll()].sort(((e,t)=>e.url>t.url?-1:e.url<t.url?1:0))[0];if(o){const e=[s,setTimeout((()=>{t.delete(r.A),s(n(r,"Timeout"))}),1e4)];t.set(r.A,e),o.postMessage(r)}else s(n(r,"No Party"))})))(r,i);o(e(JSON.stringify(a),1,1))})))(r,o))})(s,r)})(self);
